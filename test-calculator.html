<!DOCTYPE html>
<html>
<head>
    <title>Test Solar Calculator</title>
</head>
<body>
    <h2>Solar Calculator Test</h2>
    
    <div>
        <label>Monthly Electric Bill: $</label>
        <input type="number" id="electricBill" placeholder="200" min="0">
    </div>
    
    <div>
        <label>Home Size (sq ft):</label>
        <input type="number" id="homeSize" placeholder="2000" min="0">
    </div>
    
    <div>
        <label>Sun Exposure:</label>
        <input type="range" id="sunExposure" min="1" max="3" value="2">
        <span id="sunExposureValue">Good</span>
    </div>
    
    <div>
        <label>Energy Usage:</label>
        <input type="range" id="energyUsage" min="1" max="3" value="2">
        <span id="energyUsageValue">Average</span>
    </div>
    
    <div>
        <h3>Results:</h3>
        <p>Monthly Savings: <span id="monthlySavings">$0</span></p>
        <p>Annual Savings: <span id="annualSavings">$0</span></p>
        <p>System Cost: <span id="systemCost">$0</span></p>
        <p>Payback Period: <span id="paybackPeriod">0 yrs</span></p>
    </div>

    <script>
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function calculateSolarSavings() {
            console.log('Calculating solar savings...');
            const electricBill = parseFloat(document.getElementById('electricBill').value) || 0;
            const homeSize = parseFloat(document.getElementById('homeSize').value) || 0;
            const sunExposure = parseInt(document.getElementById('sunExposure').value);
            const energyUsage = parseInt(document.getElementById('energyUsage').value);
            
            console.log('Values:', {electricBill, homeSize, sunExposure, energyUsage});
            
            if (electricBill === 0 || homeSize === 0) {
                // Show placeholder values
                document.getElementById('monthlySavings').textContent = '$0';
                document.getElementById('annualSavings').textContent = '$0';
                document.getElementById('systemCost').textContent = '$0';
                document.getElementById('paybackPeriod').textContent = '0 yrs';
                return;
            }
            
            // Calculation factors
            const sunMultiplier = [0.7, 0.9, 1.2][sunExposure - 1];
            const usageMultiplier = [0.8, 1.0, 1.3][energyUsage - 1];
            
            // Basic calculations
            const systemSizeKW = (homeSize / 1000) * 8 * usageMultiplier; // Rough estimate
            const monthlyGeneration = systemSizeKW * 130 * sunMultiplier; // kWh per month
            const monthlySavings = Math.min(monthlyGeneration * 0.22, electricBill * 0.95); // Max 95% savings
            const annualSavings = monthlySavings * 12;
            const systemCost = systemSizeKW * 3200; // $3.20 per watt average
            const paybackPeriod = annualSavings > 0 ? systemCost / annualSavings : 0;
            
            console.log('Results:', {monthlySavings, annualSavings, systemCost, paybackPeriod});
            
            // Update display
            document.getElementById('monthlySavings').textContent = '$' + Math.round(monthlySavings).toLocaleString();
            document.getElementById('annualSavings').textContent = '$' + Math.round(annualSavings).toLocaleString();
            document.getElementById('systemCost').textContent = '$' + Math.round(systemCost).toLocaleString();
            document.getElementById('paybackPeriod').textContent = `${Math.round(paybackPeriod * 10) / 10} yrs`;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const electricBillInput = document.getElementById('electricBill');
            const homeSizeInput = document.getElementById('homeSize');
            const sunExposureSlider = document.getElementById('sunExposure');
            const energyUsageSlider = document.getElementById('energyUsage');
            const sunExposureValue = document.getElementById('sunExposureValue');
            const energyUsageValue = document.getElementById('energyUsageValue');
            
            // Update slider display values
            sunExposureSlider.addEventListener('input', function() {
                const exposureTexts = ['Poor', 'Good', 'Excellent'];
                sunExposureValue.textContent = exposureTexts[this.value - 1];
                calculateSolarSavings();
            });
            
            energyUsageSlider.addEventListener('input', function() {
                const usageTexts = ['Low', 'Average', 'High'];
                energyUsageValue.textContent = usageTexts[this.value - 1];
                calculateSolarSavings();
            });
            
            // Calculate on input change
            electricBillInput.addEventListener('input', debounce(calculateSolarSavings, 500));
            homeSizeInput.addEventListener('input', debounce(calculateSolarSavings, 500));
            
            // Initial calculation
            calculateSolarSavings();
        });
    </script>
</body>
</html>